% arara: pdflatex: { shell: true, interaction: nonstopmode }
% arara: bibtex
% arara: makeglossaries
% arara: makeindex
% arara: pdflatex: { shell: true, interaction: nonstopmode }
% arara: pdflatex: { shell: true, interaction: nonstopmode }
\documentclass[11pt, a4paper, oneside, twocolumn]{report}
% .  ___   ___        ___  ___  ___   ___  ___  ___   ___              ___         ___   ___   ___ 
% . |   |=|_.'   .'|=|_.' `._|=|   |=|_.' `._|=|   |=|_.'   .'|   .'| |   |   .'|=|_.'  |   |=|_.' 
% . `.  |      .'  |  ___      |   |           |   |      .'  | .'  |\|   | .'  |___    `.  |      
% .   `.|=|`.  |   |=|_.'      |   |           |   |      |   | |   | |   | |   |`._|=.   `.|=|`.  
% .  ___  |  `.|   |  ___      `.  |           `.  |      |   | |   | |  .' `.  |  __||  ___  |  `.
% .  `._|=|___||___|=|_.'        `.|             `.|      |___| |___| |.'     `.|=|_.''  `._|=|___|
% .                                                                                                
%% packages --------------------------------------------------------------------
\usepackage{pgfplots,subcaption}
%% settings --------------------------------------------------------------------
\pgfplotsset{%
  width  = \textwidth,
  height = \textwidth,
  compat = 1.17,
  colormap name = viridis,
  cycle list name = exotic,
} % tikz doesnt know the twocolumn thing
\usetikzlibrary{calc}
% \usetikzlibrary{external}
% \tikzexternalize[optimize=true,prefix=tikz/] % externalize tikz, much faster, many conflicts!
\setcounter{secnumdepth}{2} % set level of depth for numbering
% \graphicspath{{figures/}}
\renewcommand{\arraystretch}{1.2} % streches row heigth in arrays (and tables)
%% makros ----------------------------------------------------------------------
\renewcommand{\b}{\textbf}
\renewcommand{\u}{\underline}
\renewcommand{\tt}{\texttt}
\renewcommand{\t}{\todo}
\newcommand{\e}{\emph}
\newcommand{\n}{\textnormal}
\newcommand{\m}{\mathrm}
\newcommand{\x}[1]{#1\index{#1}}
\begin{document}



\begin{figure*}[!t]
  \rotatebox{90}{\b{Shift}}
  \begin{subfigure}[t!]{0.44\textwidth}
    \centering
    \b{Rigid Recovery}
    \begin{tikzpicture}
      \begin{axis}[
        enlargelimits=false, smooth,
        grid=both, grid style=dashed,
        xlabel={x / $\mu$m},
        ylabel={y / $\mu$m},
        zlabel={z / $\mu$m},
        %label shift = -10pt,
        % legend entries={blue channel, transformed red channel, red channel},
        xmin=-1,
        xmax=1,
        ymin=-1,
        ymax=1,
        grid=major,
        ]
        \addplot3[cyan, only marks, mark=*] table {sim_rigid_rec_shift/q.dat};
        \addplot3[magenta, only marks, mark=x] table {sim_rigid_rec_shift/pr.dat};
        \addplot3[magenta, mark=x] table {sim_rigid_rec_shift/netz.dat};
        \addplot3[violet, only marks, mark=*] table {sim_rigid_rec_shift/p.dat};
      \end{axis}
    \end{tikzpicture}
  \end{subfigure}
  ~
  \begin{subfigure}[t!]{0.44\textwidth}
    \centering
    \b{Affine Recovery}
    \begin{tikzpicture}
      \begin{axis}[
        enlargelimits=false, smooth,
        grid=both, grid style=dashed,
        xlabel={x / $\mu$m},
        ylabel={y / $\mu$m},
        zlabel={z / $\mu$m},
        %label shift = -10pt,
        % legend entries={blue channel, transformed red channel, red channel},
        xmin=-1,
        xmax=1,
        ymin=-1,
        ymax=1,
        grid=major,
        ]
        \addplot3[cyan, only marks, mark=*] table {sim_affine_rec_shift/q.dat};
        \addplot3[magenta, only marks, mark=x] table {sim_affine_rec_shift/pr.dat};
        \addplot3[magenta, mark=x] table {sim_affine_rec_shift/netz.dat};
        \addplot3[violet, only marks, mark=*] table {sim_affine_rec_shift/p.dat};
      \end{axis}
    \end{tikzpicture}
  \end{subfigure}
  \\
  \rotatebox{90}{\b{Rigid}}
  \begin{subfigure}[t!]{0.44\textwidth}
    \centering
    \begin{tikzpicture}
      \begin{axis}[
        enlargelimits=false, smooth,
        grid=both, grid style=dashed,
        xlabel={x / $\mu$m},
        ylabel={y / $\mu$m},
        zlabel={z / $\mu$m},
        label shift = -15pt,
        % legend entries={blue channel, transformed red channel, red channel},
        xmin=-1,
        xmax=1,
        ymin=-1,
        ymax=1,
        grid=major,
        ]
        \addplot3[cyan, only marks, mark=*] table {sim_rigid_rec_rigid/q.dat};
        \addplot3[magenta, only marks, mark=x] table {sim_rigid_rec_rigid/pr.dat};
        \addplot3[magenta, mark=x] table {sim_rigid_rec_rigid/netz.dat};
        \addplot3[violet, only marks, mark=*] table {sim_rigid_rec_rigid/p.dat};
      \end{axis}
    \end{tikzpicture}
  \end{subfigure}
  ~
  \begin{subfigure}[t!]{0.44\textwidth}
    \centering
    \begin{tikzpicture}
      \begin{axis}[
        enlargelimits=false, smooth,
        grid=both, grid style=dashed,
        xlabel={x / $\mu$m},
        ylabel={y / $\mu$m},
        zlabel={z / $\mu$m},
        label shift = -15pt,
        % legend entries={blue channel, transformed red channel, red channel},
        xmin=-1,
        xmax=1,
        ymin=-1,
        ymax=1,
        grid=major,
        ]
        \addplot3[cyan, only marks, mark=*] table {sim_affine_rec_rigid/q.dat};
        \addplot3[magenta, mark=x] table {sim_affine_rec_rigid/netz.dat};
        \addplot3[violet, only marks, mark=*] table {sim_affine_rec_rigid/p.dat};
      \end{axis}
    \end{tikzpicture}
  \end{subfigure}
  \\
  \rotatebox{90}{\b{Affine}}
  \begin{subfigure}[t!]{0.44\textwidth}
    \centering
    \begin{tikzpicture}
      \begin{axis}[
        enlargelimits=false, smooth,
        grid=both, grid style=dashed,
        xlabel={x / $\mu$m},
        ylabel={y / $\mu$m},
        zlabel={z / $\mu$m},
        label shift = -5pt,
        % legend entries={blue channel, transformed red channel, red channel},
        xmin=-2,
        xmax=2,
        ymin=-2,
        ymax=2,
        grid=major
        ]
        \addplot3[cyan, only marks, mark=*] table {sim_rigid_rec_affine/q.dat};
        \addplot3[magenta, mark=x] table {sim_rigid_rec_affine/netz.dat};
        \addplot3[violet, only marks, mark=*] table {sim_rigid_rec_affine/p.dat};
      \end{axis}
    \end{tikzpicture}
  \end{subfigure}
  ~
  \begin{subfigure}[t!]{0.44\textwidth}
    \centering
    \begin{tikzpicture}
      \begin{axis}[
        enlargelimits=false, smooth,
        grid=both, grid style=dashed,
        xlabel={x / $\mu$m},
        ylabel={y / $\mu$m},
        zlabel={z / $\mu$m},
        label shift = -5pt,
        % legend entries={blue channel, transformed red channel, red channel},
        xmin=-2,
        xmax=2,
        ymin=-2,
        ymax=2,
        grid=major,
        ]
        \addplot3[cyan, only marks, mark=*] table {sim_affine_rec_affine/q.dat};
        \addplot3[magenta, mark=x] table {sim_affine_rec_affine/netz.dat};
        \addplot3[violet, only marks, mark=*] table {sim_affine_rec_affine/p.dat};
      \end{axis}
    \end{tikzpicture}
  \end{subfigure}
  %
  \caption{Demonstration of the recovery of rigid (left) respective
    affine (right) transformations, via recovering localisations of
    simulated two channel SMLM data; transformation (magenta) from red
    channel (violet) to blue channel (cyan); for the use cases of
    translation (top), rigid transformation (middle) and affine
    transformation (bottom). Obviously a rigid transformation may not
    correctly reconstruct an affine transformed data set (bottom
    left).}
  \label{f:spiral}
\end{figure*}




\end{document}